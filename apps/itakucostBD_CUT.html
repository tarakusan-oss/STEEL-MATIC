<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô - SHEAR V.3.1 (Updated DB)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap');
        
        body { font-family: 'Sarabun', sans-serif; background-color: #f4f6f7; color: #2c3e50; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: white; padding: 35px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        h1 { color: #2c3e50; text-align: center; border-bottom: 4px solid #c0392b; padding-bottom: 15px; }
        .sub-title { text-align: center; color: #7f8c8d; font-size: 0.9em; margin-bottom: 25px; }

        /* Box Styles */
        .box { border: 1px solid #e0e0e0; padding: 25px; border-radius: 10px; margin-bottom: 25px; position: relative; background: #fff; }
        .box-title { 
            position: absolute; top: -14px; left: 20px; background: white; padding: 0 10px; 
            font-weight: bold; color: #c0392b; font-size: 1.1em; 
        }

        .row { display: flex; align-items: center; margin-bottom: 15px; flex-wrap: wrap; }
        .row label { flex: 2; font-weight: 600; min-width: 200px; color: #34495e; }
        .row input[type="number"], .row input[type="text"], .row select { 
            flex: 1.5; padding: 10px; border: 1px solid #bdc3c7; border-radius: 6px; text-align: right; font-family: 'Sarabun'; font-size: 1em; 
        }
        .unit { width: 70px; margin-left: 10px; color: #7f8c8d; font-size: 0.9em; }

        /* Highlight Auto Calculated Fields */
        .auto-fill { background-color: #fdedec; color: #c0392b; font-weight: bold; border: 1px solid #fadbd8; cursor: not-allowed; }

        /* Button */
        .btn-calc { 
            width: 100%; padding: 18px; border: none; background: #e74c3c; color: white; 
            font-size: 1.5em; font-weight: bold; border-radius: 10px; cursor: pointer; transition: 0.2s; box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .btn-calc:hover { background: #c0392b; transform: translateY(-3px); }

        /* Result Area */
        #resultArea { margin-top: 35px; display: none; background: #fffde7; padding: 25px; border-radius: 12px; border: 2px dashed #f1c40f; }
        table { width: 100%; border-collapse: collapse; background: white; margin-top: 15px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        th, td { border: 1px solid #ecf0f1; padding: 14px; text-align: right; }
        td:first-child { text-align: left; font-weight: bold; color: #2c3e50; }
        th { background: #34495e; color: white; text-align: center; font-weight: normal; }

        /* Palette Option Radio */
        .radio-group { flex: 1.5; display: flex; gap: 15px; }
        .radio-item { display: flex; align-items: center; gap: 5px; font-size: 0.9em; cursor: pointer; }
        .radio-item input { width: 18px; height: 18px; cursor: pointer; }

        .sub-total-row { background: #fdf2e9; color: #d35400; font-weight: bold; }
        .grand-total-row { background: #d5f5e3; color: #196f3d; font-weight: bold; font-size: 1.3em; }
    </style>
</head>
<body>

<div class="container">
    <h1>‚úÇÔ∏è SHEAR Cost Calculator V.3.1</h1>
    <div class="sub-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£‡πÉ‡∏´‡∏°‡πà (New DB)</div>

    <div class="box">
        <div class="box-title">1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö (Raw Material)</div>
        
        <div class="row" style="background: #e8f6f3; padding: 10px; border-radius: 8px; border: 1px solid #1abc9c;">
            <label style="color: #16a085;">Machine:</label>
            <select id="machineName" onchange="autoFillDB()">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                <option value="L1">L1 (HP 212)</option>
                <option value="L2">L2 (HP 186)</option>
                <option value="L3">L3 (HP 520)</option>
                <option value="M1">M1 (HP 100)</option>
                <option value="M2">M2 (HP 70)</option>
                <option value="M3">M3 (HP 70)</option>
                <option value="M4">M4 (HP 70)</option>
            </select>
        </div>

        <div class="row">
            <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ (Thickness):</label>
            <input type="number" id="thickness" placeholder="1.2" oninput="calculateMaterial()"> <span class="unit">mm</span>
        </div>
        <div class="row">
            <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏°‡πâ‡∏ß‡∏ô (Weight):</label>
            <input type="number" id="weight" placeholder="5000" oninput="calculateMaterial()"> <span class="unit">kg</span>
        </div>
        <div class="row">
            <label>‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏ß‡πâ‡∏≤‡∏á (Width):</label>
            <input type="number" id="width" placeholder="1219" oninput="calculateMaterial()"> <span class="unit">mm</span>
        </div>
        <div class="row">
            <label style="color: #c0392b;">üìè ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏°‡πâ‡∏ß‡∏ô (Total Length):</label>
            <input type="text" id="calcLength" class="auto-fill" readonly value="0.00"> <span class="unit">m</span>
        </div>
    </div>

    <div class="box">
        <div class="box-title">2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏û‡πá‡∏Ñ (Packing Logic) üì¶</div>
        
        <div class="row">
            <label style="color:#2980b9; font-size:1.1em;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ï‡∏±‡∏î (Cut Length):</label>
            <input type="number" id="cutLength" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2438" oninput="calculateMaterial()"> <span class="unit">mm</span>
        </div>
        
        <div class="row" style="background: #ebf5fb; border:1px solid #a9cce3; border-radius:6px; padding:10px;">
            <label style="color: #2980b9;">üìÑ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (Total Sheets):</label>
            <input type="text" id="totalSheetsShow" readonly style="background:transparent; border:none; font-weight:bold; font-size:1.2em; color:#2980b9;" value="0"> 
            <span class="unit" style="color:#2980b9;">‡πÅ‡∏ú‡πà‡∏ô</span>
        </div>

        <hr style="border: 0; border-top: 1px dashed #ccc; margin: 15px 0;">

        <div class="row">
            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏•‡∏±‡∏á (Qty/Pallet):</label>
            <input type="number" id="sheetsPerPallet" placeholder="500" oninput="calculatePalletsPreview()"> <span class="unit">‡πÅ‡∏ú‡πà‡∏ô</span>
        </div>
        
        <div class="row">
            <label style="color:#d35400;">‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡πÄ‡∏®‡∏© (Remainder Logic):</label>
            <div class="radio-group">
                <div class="radio-item">
                    <input type="radio" id="optSeparate" name="remOption" value="separate" checked onchange="calculatePalletsPreview()">
                    <label for="optSeparate">üì¶ ‡πÅ‡∏¢‡∏Å‡∏•‡∏±‡∏á‡πÉ‡∏´‡∏°‡πà (+1 ‡∏•‡∏±‡∏á)</label>
                </div>
                <div class="radio-item">
                    <input type="radio" id="optMerge" name="remOption" value="merge" onchange="calculatePalletsPreview()">
                    <label for="optMerge">üì• ‡∏£‡∏ß‡∏°‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏° (‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏±‡∏á)</label>
                </div>
            </div>
        </div>

        <div class="row" style="margin-top:10px;">
            <label>‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ:</label>
            <input type="text" id="calcPallets" class="auto-fill" readonly value="0"> <span class="unit">‡∏•‡∏±‡∏á</span>
        </div>
    </div>

    <input type="hidden" id="timePerStroke">
    <input type="hidden" id="shearHP">
    <input type="hidden" id="setupTime">
    <input type="hidden" id="palletTime">
    <input type="hidden" id="dbCoilBackTime">
    
    <div class="box">
        <div class="box-title">3. ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü</div>
        <div class="row">
            <label>‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á (Labor Rate):</label>
            <input type="number" id="laborRate" value="75"> <span class="unit">‡∏ö‡∏≤‡∏ó/‡∏ä‡∏°.</span>
        </div>
        <div class="row">
            <label>‡∏Ñ‡∏ô‡∏á‡∏≤‡∏ô (Manpower):</label>
            <input type="number" id="manpower" value="3"> <span class="unit">‡∏Ñ‡∏ô</span>
        </div>
        <div class="row">
            <label>‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (Elec Rate):</label>
            <input type="number" id="elecRate" value="5.0"> <span class="unit">‡∏ö‡∏≤‡∏ó/Unit</span>
        </div>
        <div class="row">
             <label>Coil Back:</label>
             <div class="checkbox-wrapper"><input type="checkbox" id="useCoilBack"> <span style="font-size:0.9em;">‡∏°‡πâ‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö</span></div>
        </div>
    </div>

    <button class="btn-calc" onclick="calculateFinal()">‚úÇÔ∏è ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (Calculate) ‚úÇÔ∏è</button>

    <div id="resultArea">
        <h2 style="text-align: center; color: #c0392b;">üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Cost Breakdown)</h2>
        <div id="warnMsg" style="color:red; text-align:center;"></div>
        <table>
            <tbody id="resultBody"></tbody>
            <tfoot>
                <tr class="sub-total-row"><td colspan="2">‡∏£‡∏ß‡∏°‡πÄ‡∏ß‡∏•‡∏≤ (Total Time)</td><td id="grandTime">0.00 min</td></tr>
                <tr><td colspan="2">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á (Labor Cost)</td><td id="laborCostTotal">0.00 THB</td></tr>
                <tr><td colspan="2">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (Energy Cost)</td><td id="energyCostTotal">0.00 THB</td></tr>
                <tr class="grand-total-row"><td colspan="2" align="center">‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (Grand Total)</td><td id="grandTotalCost">0.00 THB</td></tr>
            </tfoot>
        </table>
    </div>
</div>

<script>
    // --- üíæ DATABASE UPDATE ---
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ñ‡∏£‡∏±‡∏ö! (stroke ‡∏ä‡πâ‡∏≤‡∏•‡∏á, setup SK ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á)
    // setup = Setup Time (15), pallet = SETUP SK, back = COIL BACK (10)
    const machineDB = {
        "L1": [ 
            { min: 400, max: 499, stroke: 2.0, hp: 212, setup: 15, pallet: 10, back: 10 }, 
            { min: 500, max: 999, stroke: 2.5, hp: 212, setup: 15, pallet: 10, back: 10 }, 
            { min: 1000, max: 1999, stroke: 3.0, hp: 212, setup: 15, pallet: 10, back: 10 }, 
            { min: 2000, max: 3000, stroke: 4.0, hp: 212, setup: 15, pallet: 10, back: 10 } 
        ],
        "L2": [ 
            { min: 400, max: 499, stroke: 2.0, hp: 186, setup: 15, pallet: 7, back: 10 }, 
            { min: 500, max: 999, stroke: 2.4, hp: 186, setup: 15, pallet: 7, back: 10 }, 
            { min: 1000, max: 1999, stroke: 2.8, hp: 186, setup: 15, pallet: 7, back: 10 }, 
            { min: 2000, max: 3000, stroke: 3.0, hp: 186, setup: 15, pallet: 7, back: 10 } 
        ],
        "L3": [ 
            { min: 400, max: 499, stroke: 2.0, hp: 520, setup: 15, pallet: 5, back: 10 }, 
            { min: 500, max: 999, stroke: 2.5, hp: 520, setup: 15, pallet: 5, back: 10 }, 
            { min: 1000, max: 1999, stroke: 2.7, hp: 520, setup: 15, pallet: 5, back: 10 }, 
            { min: 2000, max: 3000, stroke: 3.0, hp: 520, setup: 15, pallet: 5, back: 10 } 
        ],
        "M1": [ 
            { min: 400, max: 499, stroke: 8.0, hp: 100, setup: 15, pallet: 10, back: 10 }, 
            { min: 500, max: 999, stroke: 9.0, hp: 100, setup: 15, pallet: 10, back: 10 }, 
            { min: 1000, max: 1999, stroke: 10.0, hp: 100, setup: 15, pallet: 10, back: 10 }, 
            { min: 2000, max: 3000, stroke: 12.0, hp: 100, setup: 15, pallet: 10, back: 10 } 
        ],
        "M2": [ 
            { min: 400, max: 499, stroke: 7.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 500, max: 999, stroke: 8.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 1000, max: 1999, stroke: 9.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 2000, max: 3000, stroke: 10.0, hp: 70, setup: 15, pallet: 10, back: 10 } 
        ],
        "M3": [ 
            { min: 400, max: 499, stroke: 7.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 500, max: 999, stroke: 8.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 1000, max: 1999, stroke: 9.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 2000, max: 3000, stroke: 10.0, hp: 70, setup: 15, pallet: 10, back: 10 } 
        ],
        "M4": [ 
            { min: 400, max: 499, stroke: 7.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 500, max: 999, stroke: 8.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 1000, max: 1999, stroke: 9.0, hp: 70, setup: 15, pallet: 10, back: 10 }, 
            { min: 2000, max: 3000, stroke: 10.0, hp: 70, setup: 15, pallet: 10, back: 10 } 
        ]
    };

    // --- 1. Calculate Basic Material & Sheets ---
    function calculateMaterial() {
        const weight = parseFloat(document.getElementById('weight').value) || 0;
        const thickness = parseFloat(document.getElementById('thickness').value) || 0;
        const width = parseFloat(document.getElementById('width').value) || 0;
        const cutLenMm = parseFloat(document.getElementById('cutLength').value) || 0;
        
        let lengthM = 0;
        let totalSheets = 0;

        // 1.1 Calc Length
        if(thickness > 0 && width > 0) {
            lengthM = weight / (thickness * 7.85 * (width/1000));
        }
        document.getElementById('calcLength').value = lengthM.toFixed(2);

        // 1.2 Calc Sheets (‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á)
        if(cutLenMm > 0 && lengthM > 0) {
            totalSheets = Math.floor(lengthM / (cutLenMm / 1000)); // ‡∏õ‡∏±‡∏î‡πÄ‡∏®‡∏©‡∏•‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏ú‡πà‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏ï‡∏±‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
        }
        document.getElementById('totalSheetsShow').value = totalSheets;

        autoFillDB();
        calculatePalletsPreview();
    }

    // --- 2. Auto Fill DB ---
    function autoFillDB() {
        const machine = document.getElementById('machineName').value;
        const cutLen = parseFloat(document.getElementById('cutLength').value) || 0;
        
        // Reset
        document.getElementById('timePerStroke').value = "";
        document.getElementById('shearHP').value = "";
        document.getElementById('setupTime').value = "";
        document.getElementById('palletTime').value = ""; 
        document.getElementById('dbCoilBackTime').value = "";

        if (machine && cutLen > 0) {
            const specs = machineDB[machine];
            let found = false;
            for (let spec of specs) {
                if (cutLen >= spec.min && cutLen <= spec.max) {
                    document.getElementById('timePerStroke').value = spec.stroke;
                    document.getElementById('shearHP').value = spec.hp;
                    document.getElementById('setupTime').value = spec.setup;
                    document.getElementById('palletTime').value = spec.pallet; // ‡∏î‡∏∂‡∏á Setup SK ‡∏°‡∏≤
                    document.getElementById('dbCoilBackTime').value = spec.back;
                    found = true;
                    break;
                }
            }
        }
    }

    // --- 3. Preview Pallet Count (Logic ‡πÅ‡∏¢‡∏Å/‡∏£‡∏ß‡∏°‡∏•‡∏±‡∏á) ---
    function calculatePalletsPreview() {
        const totalSheets = parseInt(document.getElementById('totalSheetsShow').value) || 0;
        const qtyPerPallet = parseInt(document.getElementById('sheetsPerPallet').value) || 0;
        const isSeparate = document.getElementById('optSeparate').checked;
        
        let palletCount = 0;

        if (totalSheets > 0 && qtyPerPallet > 0) {
            const fullPallets = Math.floor(totalSheets / qtyPerPallet);
            const remainder = totalSheets % qtyPerPallet;

            if (remainder === 0) {
                palletCount = fullPallets;
            } else {
                if (isSeparate) {
                    // ‡πÅ‡∏¢‡∏Å: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å 1 ‡∏•‡∏±‡∏á
                    palletCount = fullPallets + 1;
                } else {
                    // ‡∏£‡∏ß‡∏°: ‡πÉ‡∏™‡πà‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏° (‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏¢ ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡∏ö 1)
                    palletCount = (fullPallets === 0) ? 1 : fullPallets;
                }
            }
        }
        document.getElementById('calcPallets').value = palletCount;
    }

    // --- 4. Final Calculation ---
    function calculateFinal() {
        calculateMaterial(); // Refresh all
        
        const totalSheets = parseInt(document.getElementById('totalSheetsShow').value) || 0;
        const palletCount = parseFloat(document.getElementById('calcPallets').value) || 0;
        
        // Params
        const strokeTime = parseFloat(document.getElementById('timePerStroke').value);
        const setup = parseFloat(document.getElementById('setupTime').value) || 0;
        const palletSetTime = parseFloat(document.getElementById('palletTime').value) || 0;
        const hp = parseFloat(document.getElementById('shearHP').value) || 0;
        const isBack = document.getElementById('useCoilBack').checked;
        const backTime = isBack ? (parseFloat(document.getElementById('dbCoilBackTime').value) || 0) : 0;

        // Rate
        const laborRate = parseFloat(document.getElementById('laborRate').value) || 0;
        const manpower = parseFloat(document.getElementById('manpower').value) || 0;
        const elecRate = parseFloat(document.getElementById('elecRate').value) || 0;

        if(!strokeTime) { alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Machine ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà Cut Length ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (400-3000 mm) ‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡πà‡∏∞"); return; }

        // Time Calc
        const runTime = (totalSheets * strokeTime) / 60;
        const handlingTime = palletCount * palletSetTime; // ‡πÉ‡∏ä‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å Logic ‡∏°‡∏≤‡∏Ñ‡∏π‡∏ì‡πÄ‡∏ß‡∏•‡∏≤ SK ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÜ
        const totalTime = setup + runTime + handlingTime + backTime;

        // Cost Calc
        const laborCost = totalTime * manpower * (laborRate/60);
        // ‡∏™‡∏π‡∏ï‡∏£‡πÑ‡∏ü: (HP * 0.746 * Load 0.8) / Eff 0.9
        const energyCost = (hp * 0.746 * 0.8 / 0.9) * (totalTime/60) * elecRate;

        // Render
        let html = "";
        html += `<tr><td>1. Setup</td><td>‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á)</td><td>${setup} min</td></tr>`;
        html += `<tr><td>2. Running</td><td>${totalSheets} ‡πÅ‡∏ú‡πà‡∏ô x ${strokeTime}s</td><td>${runTime.toFixed(2)} min</td></tr>`;
        html += `<tr><td>3. Pallet</td><td>${palletCount} ‡∏•‡∏±‡∏á x ${palletSetTime} min</td><td>${handlingTime.toFixed(2)} min</td></tr>`;
        if(isBack) html += `<tr><td>4. Coil Back</td><td>‡πÄ‡∏Å‡πá‡∏ö‡∏°‡πâ‡∏ß‡∏ô (‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á)</td><td>${backTime} min</td></tr>`;

        document.getElementById('resultBody').innerHTML = html;
        document.getElementById('grandTime').innerText = totalTime.toFixed(2) + " min";
        document.getElementById('laborCostTotal').innerText = laborCost.toFixed(2) + " THB";
        document.getElementById('energyCostTotal').innerText = energyCost.toFixed(2) + " THB";
        document.getElementById('grandTotalCost').innerText = (laborCost + energyCost).toFixed(2) + " THB";

        document.getElementById('resultArea').style.display = 'block';
    }
</script>

</body>
</html>